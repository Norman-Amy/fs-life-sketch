<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

    <script src="../../webcomponentsjs/webcomponents.js"></script>
    <script src="../../web-component-tester/browser.js"></script>
    <script src="../../es6-promise-polyfill/promise.js"></script>
    <script src="../../fetch/fetch.js"></script>
    <script src="../../fetch-mock/index.js"></script>

    <!-- Step 1: import the element to test -->
    <link rel="import" href="../fs-life-sketch.html">
    <link rel="import" href="./person-test-data.html">
  </head>
  <body>

    <!-- You can use the document as a place to set up your fixtures. -->
    <!-- Active data -->
    <test-fixture id="fs-life-sketch-fixture-active">
      <template>
        <fs-life-sketch person-id="KWC4-TLH" language="en" session-id="session_ID" ajax-base="beta.familysearch.org"></fs-life-sketch>
      </template>
    </test-fixture>

    <!-- Passive data -->
    <test-fixture id="fs-life-sketch-fixture-passive">
      <template>
        <fs-life-sketch person-obj='{"name":"Anna Elizabeth Hyler","id":"KWC4-TLH","isLiving":false,"lifeSketchConclusion":{"details":{"contributor":{"name":"Amy_Norman","date":"1 December 1896"},"value":"This is a lifesketch","id":"lifesketch_ID"}}}' language="en" session-id="session_ID" ajax-base="beta.familysearch.org"></fs-life-sketch>
      </template>
    </test-fixture>

    <script>
    (function(){
      describe('<fs-life-sketch>', function(){
        var lifesketchFixtureActive,
            lifesketchFixturePassive,
            get_url;

        beforeEach(function() {
          get_url = /\/tree-data\/person\//;
          // Stub the fetch call from person-data-service
          fetchMock.get(get_url, { "data": annaHylerEndpoint })

          lifesketchFixtureActive = fixture('fs-life-sketch-fixture-active');
          lifesketchFixturePassive = fixture('fs-life-sketch-fixture-passive');
        });

        afterEach(function() {
          fetchMock.restore();
        });

        describe('setup', function(){
          it('defines the properties correctly before rendering lifesketchFixtureActive', function() {
            assert.equal(lifesketchFixtureActive.lifesketch, "", "Incorrect lifesketch");
            assert.equal(lifesketchFixtureActive.personObj, undefined, "Incorrect personObj");
            assert.equal(lifesketchFixtureActive.personId, "KWC4-TLH", "Incorrect personId");
            assert.equal(lifesketchFixtureActive.fullPerson, true, "Incorrect fullPerson property");
            assert.equal(lifesketchFixtureActive.conclusionId, "", "Incorrect conclusionId property");
            assert.equal(lifesketchFixtureActive.errorMessageText, "", "Incorrect errorMessageText property");
            assert.equal(lifesketchFixtureActive.showForm, false, "Incorrect showForm property");
            assert.deepEqual(lifesketchFixtureActive.contributor, {}, "Incorrect contributor property");
            assert.equal(lifesketchFixtureActive.showModifiedTodayText, false, "Incorrect showModifiedTodayText property");
            assert.equal(lifesketchFixtureActive.charCount, 10000, "Incorrect charCount property");
            assert.equal(lifesketchFixtureActive.loadingClass, "spinner", "Incorrect loadingClass property");
          });

          it('defines the properties correctly before rendering lifesketchFixturePassive', function() {
            lifesketchFixturePassive.personObj = JSON.parse(lifesketchFixturePassive.personObj);
            assert.equal(lifesketchFixturePassive.lifesketch, "This is a lifesketch", "Incorrect lifesketch");
            assert.equal(lifesketchFixturePassive.personObj.name, "Anna Elizabeth Hyler", "Incorrect personObj");
            assert.equal(lifesketchFixturePassive.personId, undefined, "Incorrect personId");
            assert.equal(lifesketchFixturePassive.fullPerson, true, "Incorrect fullPerson property");
            assert.equal(lifesketchFixturePassive.conclusionId, "lifesketch_ID", "Incorrect conclusionId property");
            assert.equal(lifesketchFixtureActive.errorMessageText, "", "Incorrect errorMessageText property");
            assert.equal(lifesketchFixtureActive.showForm, false, "Incorrect showForm property");
            assert.deepEqual(lifesketchFixtureActive.contributor, {}, "Incorrect contributor property");
            assert.equal(lifesketchFixtureActive.showModifiedTodayText, false, "Incorrect showModifiedTodayText property");
            assert.equal(lifesketchFixtureActive.charCount, 10000, "Incorrect charCount property");
            assert.equal(lifesketchFixtureActive.loadingClass, "spinner", "Incorrect loadingClass property");
          });
        });

        describe('function tests' , function(){

        });
      });
    })();
    </script>

  </body>
</html>
